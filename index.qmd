---
title: "Ensamble de Genoma Bacteriano"
author: "OMICs Analysis"
format: 
  html:
    toc: true
    toc-depth: 3
    theme: journal
editor: visual
execute:
  engine: knitr
lang: es
---

![](images/logo_OAN_for_white.png){fig-align="center" width="300"}

# Introducción

Para este tutorial vamos a ensamblar un Genoma usando lecturas largas y cortas. Vamos a trabajar con secuencias de *Clostridioides difficile.*

Los siguientes pasos se realizaron utilizando una máquina `Gigabyte Technology Co., Ltd. H67MA-USB3-B3` con procesador `Intel® Core™ i7-2600 CPU @ 3.40GHz × 8` y 32 Gb de RAM. Con sistema Operativo `Ubuntu 22.04.5 LTS`.

Para todos los procesos se generó un directorio con la siguiente estructura:

```{bash, eval=FALSE}
2025_Demo_Assembly/
├── bin/
└── data/
```

Para cada pasó se irá generando un carpeta dentro del directorio `2025_Demo_Assembly`.

## Obtención de lecturas

En este paso vamos a utilizar `sratoolkit`, lo puedes descargar [aquí](https://github.com/ncbi/sra-tools/wiki/02.-Installing-SRA-Toolkit) según sea tu sistema operativo.

Los datos los vamos a descargar del BioProject [`PRJNA1148956`](https://www.ncbi.nlm.nih.gov/bioproject?LinkName=sra_bioproject&from_uid=34977980) **"Comparative study of Illumina and Nanopore sequencing for Clostridioides difficile surveillance"**. Para fines demostrativos vamos a descargar lecturas largas (Nanopore) y lecturas cortas pareadas (Ilumina).

Para hacerlo usa el siguiente código en la terminal:

**Lecturas largas**

```{bash, eval=FALSE}
cd 2025_Demo_Assembly/data
prefetch SRR30483153
fasterq-dump SRR30483153
```

**Lecturas cortas**

```{bash, eval=FALSE}
cd data
prefetch SRR30483121
fasterq-dump SRR30483121
```

Con esto obtendremos los archivos `.fastq` de las lecturas con su respectiva puntuación `Phred`.

# 1. Control de Calidad

Para observar la calidad de nuestras secuencias vamos a utilizar [`FastQC`](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/) (generalmente usado para lecturas cortas) y [`NanoPlot`](https://github.com/wdecoster/NanoPlot) (óptimo para lecturas largas), al hacer click en cada palabra podrás acceder al sitio para poder descargarlos e instalarlos. `FastQC` nos mostrará los resultados de calidad en un reporte `HTML` interactivo, y `NanoPlot` generá graficos en `.png` de las medidas de calidad.

Para ejecutar las herramientas usa los siguientes códigos en la terminal:

Primero generamos las carpetas para depositar los resultados

```{bash, eval=FALSE}
mkdir 2025_Demo_Assembly/1_fastaQC/fastQC
mkdir 2025_Demo_Assembly/1_fastQC/NanoPlot
```

## **FastQC**

Al ejecutar fastqc se abrirá una interfaz gráfica donde podremos introducir nuestras secuencias.

```{bash, eval=FALSE}
fastqc
```

### **Lecturas largas con FastQC**

![](images/ONT_fastqc.png){fig-align="center"}

### **Lecturas cortas con FastQC**

Forward

![](images/f_fastqc.png){fig-align="center"}

Reverse

![](images/r_fastqc.png){fig-align="center"}

## NanoPlot

Lecturas largas

```{bash, eval=FALSE}
NanoPlot \
-t 6 \
--fastq data/SRR30483153.fastq \
--verbose \
--store \
-o 1_fastQC/NanoPlot/nanopore \
--tsv_stats \
--info_in_report
```

![](images/ONT_LengthvsQualityScatterPlot_kde.png){fig-align="center"}

Lecturas cortas

```{bash, eval=FALSE}
NanoPlot \
-t 6 \
--fastq data/SRR30483121_1.fastq data/SRR30483121_2.fastq \
--verbose \
--store \
-o 1_fastaQC/NanoPlot/ilumina \
--tsv_stats \
--info_in_report
```

![](images/ilumina_LengthvsQualityScatterPlot_kde.png){fig-align="center"}
